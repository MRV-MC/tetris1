<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetris Online - Multiplayer</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Menu Screen -->
    <div id="menu-screen" class="screen active">
        <div class="container">
            <h1 class="game-title">TETRIS</h1>
            <h2 class="subtitle">ONLINE MULTIPLAYER</h2>
            
            <div class="menu-form">
                <input type="text" id="player-name" placeholder="Your name" maxlength="15">
                
                <div class="button-group">
                    <button id="create-room-btn" class="btn btn-primary">Create Room</button>
                    <button id="join-room-btn" class="btn btn-secondary">Join Room</button>
                </div>
                
                <div id="join-form" class="hidden">
                    <input type="text" id="room-code" placeholder="Room Code" maxlength="6">
                    <button id="confirm-join-btn" class="btn btn-accent">Join</button>
                </div>
            </div>
            
            <div class="rooms-section">
                <h3>Available Rooms</h3>
                <div id="rooms-list" class="rooms-list">
                    <p class="no-rooms">No rooms available</p>
                </div>
            </div>
            
            <div class="menu-actions">
                <button id="stats-btn" class="btn btn-secondary">Statistics</button>
                <button id="settings-btn" class="btn btn-secondary">Settings</button>
            </div>
        </div>
    </div>

    <!-- Achievements Screen -->
    <div id="achievements-screen" class="screen">
        <div class="container">
            <h2>Achievements</h2>
            <div class="achievements-list" id="achievements-list">
                <!-- Achievements will be populated here -->
            </div>
            <div class="modal-actions">
                <button id="close-achievements-btn" class="btn btn-primary">Close</button>
            </div>
        </div>
    </div>

    <!-- Settings Screen -->
    <div id="settings-screen" class="screen">
        <div class="container">
            <h2>Settings</h2>
            <div class="settings-form">
                <div class="setting-group">
                    <label for="sound-volume">Sound Volume</label>
                    <input type="range" id="sound-volume" min="0" max="100" value="100">
                    <span id="sound-volume-value">100%</span>
                </div>
                
                <div class="setting-group">
                    <label for="block-size">Block Size</label>
                    <select id="block-size">
                        <option value="small">Small</option>
                        <option value="medium" selected>Medium</option>
                        <option value="large">Large</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label for="theme">Theme</label>
                    <select id="theme">
                        <option value="classic" selected>Classic</option>
                        <option value="neon">Neon</option>
                        <option value="retro">Retro</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="show-ghost" checked>
                        Show Ghost Piece
                    </label>
                </div>
                
                <div class="setting-group">
                    <label for="das-speed">DAS Speed (ms)</label>
                    <input type="range" id="das-speed" min="50" max="200" value="100">
                    <span id="das-speed-value">100ms</span>
                </div>
                
                <div class="modal-actions">
                    <button id="save-settings-btn" class="btn btn-primary">Save</button>
                    <button id="cancel-settings-btn" class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Lobby Screen -->
    <div id="lobby-screen" class="screen">
        <div class="container">
            <h2>Room: <span id="room-id"></span></h2>
            
            <div class="players-panel">
                <div class="player-card">
                    <h3>Host</h3>
                    <p id="host-name">-</p>
                    <span id="host-status" class="status">Not Ready</span>
                </div>
                <div class="vs">VS</div>
                <div class="player-card">
                    <h3>Guest</h3>
                    <p id="guest-name">Waiting...</p>
                    <span id="guest-status" class="status">-</span>
                </div>
            </div>
            
            <div class="lobby-actions">
                <button id="ready-btn" class="btn btn-primary">Ready</button>
                <button id="leave-room-btn" class="btn btn-danger">Leave Room</button>
            </div>
            
            <p class="hint">Both players must be ready to start</p>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="screen">
        <div class="game-container">
            <!-- Player Board -->
            <div class="game-panel player-panel">
                <div class="panel-header">
                    <h3 id="player-game-name">You</h3>
                </div>
                <div class="game-info">
                    <div class="info-item">
                        <span class="label">Score</span>
                        <span id="player-score" class="value">0</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Lines</span>
                        <span id="player-lines" class="value">0</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Level</span>
                        <span id="player-level" class="value">1</span>
                    </div>
                </div>
                <div id="combo-indicator" class="combo-indicator hidden">
                    <span id="combo-text">COMBO x<span id="combo-count">1</span></span>
                </div>
                <div class="hold-piece">
                    <span class="label">Hold</span>
                    <canvas id="player-hold" width="120" height="120"></canvas>
                </div>
                <canvas id="player-board" width="500" height="1000"></canvas>
                <div class="next-piece">
                    <span class="label">Next</span>
                    <canvas id="player-next" width="120" height="120"></canvas>
                </div>
            </div>

            <!-- Opponent Board -->
            <div class="game-panel opponent-panel">
                <div class="panel-header">
                    <h3 id="opponent-game-name">Opponent</h3>
                </div>
                <div class="game-info">
                    <div class="info-item">
                        <span class="label">Score</span>
                        <span id="opponent-score" class="value">0</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Lines</span>
                        <span id="opponent-lines" class="value">0</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Level</span>
                        <span id="opponent-level" class="value">1</span>
                    </div>
                </div>
                <canvas id="opponent-board" width="500" height="1000"></canvas>
                <div class="next-piece">
                    <span class="label">Next</span>
                    <canvas id="opponent-next" width="80" height="80"></canvas>
                </div>
            </div>
        </div>

        <div class="controls-hint">
            <p><kbd>←</kbd><kbd>→</kbd> or <kbd>A</kbd><kbd>D</kbd> Move | <kbd>↑</kbd> or <kbd>W</kbd> Rotate | <kbd>↓</kbd> or <kbd>S</kbd> Soft Drop | <kbd>Space</kbd> Hard Drop | <kbd>C</kbd> Hold</p>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="game-over-modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="game-result">Game Over</h2>
            <div class="final-scores">
                <div class="final-score">
                    <span id="winner-name">Winner</span>
                    <span id="winner-score">0</span>
                </div>
                <div class="final-score loser">
                    <span id="loser-name">Loser</span>
                    <span id="loser-score">0</span>
                </div>
            </div>
            <div class="modal-actions">
                <button id="play-again-btn" class="btn btn-primary">Play Again</button>
                <button id="back-to-menu-btn" class="btn btn-secondary">Back to Menu</button>
            </div>
        </div>
    </div>

    <!-- Statistics Modal -->
    <div id="stats-modal" class="modal hidden">
        <div class="modal-content stats-content">
            <h2>Game Statistics</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-label">LPS</span>
                    <span id="stat-lps" class="stat-value">0.00</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">PPM</span>
                    <span id="stat-ppm" class="stat-value">0.0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">APM</span>
                    <span id="stat-apm" class="stat-value">0.0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Max Combo</span>
                    <span id="stat-combo" class="stat-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Pieces</span>
                    <span id="stat-pieces" class="stat-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Time</span>
                    <span id="stat-time" class="stat-value">0s</span>
                </div>
            </div>
            <h3 style="margin-top: 30px; margin-bottom: 15px;">All-Time Best</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-label">Best Score</span>
                    <span id="stat-best-score" class="stat-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best LPS</span>
                    <span id="stat-best-lps" class="stat-value">0.00</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best PPM</span>
                    <span id="stat-best-ppm" class="stat-value">0.0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best APM</span>
                    <span id="stat-best-apm" class="stat-value">0.0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best Combo</span>
                    <span id="stat-best-combo" class="stat-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total Games</span>
                    <span id="stat-total-games" class="stat-value">0</span>
                </div>
            </div>
            <div class="modal-actions">
                <button id="close-stats-btn" class="btn btn-primary">Close</button>
            </div>
        </div>
    </div>

    <!-- Connection Status -->
    <div id="connection-status" class="connection-status">
        <span class="status-dot"></span>
        <span class="status-text">Connecting...</span>
    </div>

    <!-- Notifications -->
    <div id="notifications-container" class="notifications-container"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="game.js"></script>
</body>
</html>
